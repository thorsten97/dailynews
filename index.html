
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Summarized News</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif; background: #fff; color: #111; max-width: 1000px; margin: 0 auto; padding: 2em;}
        h1 { font-size: 1.8em; margin-bottom: 1em; }
        .tabs { display: flex; border-bottom: 2px solid #222; margin-bottom: 1.5em;}
        .tab { padding: 0.7em 1.5em; cursor: pointer; border: none; background: none; color: #111; font-weight: bold; font-size: 1.1em; }
        .tab.active { border-bottom: 3px solid #111; }
        .date-row { display: flex; align-items: center; gap: 1em; margin-bottom: 1.5em; justify-content: space-between; }
        .date-select { font-size: 1em; padding: 0.5em 1em; border: 1px solid #222; background: #fff; color: #111; font-weight: bold; }
        .speech-buttons { display: flex; gap: 0.5em; align-items: center; }
        .speech-rate { margin-right: 1em; }
        .read-aloud-btn { font-size: 0.9em; padding: 0.5em 1em; border: 1px solid #666; background: #f0f0f0; color: #333; cursor: pointer; border-radius: 3px; font-weight: bold; }
        .read-aloud-btn:hover { background: #e0e0e0; }
        .read-aloud-btn.reading { background: #007acc; color: #fff; border-color: #007acc; }
        .speech-controls { margin-bottom: 1em; padding: 0.5em; background: #f9f9f9; border-radius: 5px; }
        .folders { display: flex; flex-wrap: wrap; margin-bottom: 1em; gap: 0.5em; }
        .folder { background: #fff; border: 1px solid #222; padding: 0.5em 1em; cursor: pointer; font-weight: bold; margin-right: 0.5em; }
        .folder.active { background: #222; color: #fff; }
        .article { margin-bottom: 2em; padding-bottom: 1em; border-bottom: 1px solid #ccc; }
        .headline { font-weight: bold; font-size: 1.25em; margin-bottom: 0.2em; }
        .date { color: #555; font-size: 0.9em; margin-bottom: 0.4em; }
        .summary { margin-bottom: 0.2em; }
        .profile-content { line-height: 1.6; }
        .person-context { background: #f0f8ff; padding: 1em; border-left: 4px solid #007acc; margin: 1em 0; border-radius: 5px; }
        .biography { margin-top: 1.5em; }
        .updated { color: #888; font-size: 0.9em; margin-top: 2em; text-align: right; }
        @media (max-width: 700px) {
          .date-row { flex-direction: column; align-items: stretch; gap: 0.5em; }
        }
    </style>
</head>
<body>
    <h1>Nyhetsbloggen</h1>
    <div class="tabs">
        <button class="tab active" id="tab-sammanfattning">Sammanfattning</button>
        <button class="tab" id="tab-profil">Profil</button>
        <button class="tab" id="tab-djupanalys">Djupanalys</button>
        <button class="tab" id="tab-nyheter">Nyheter</button>
    </div>
    <div class="date-row">
        <select class="date-select" id="date-select">
            <option value="2025-07-19" selected>2025-07-19</option>
        </select>
        <div class="speech-buttons">
            <span class="speech-rate">
                Hastighet: <select id="speech-rate">
                    <option value="0.5">L√•ngsam</option>
                    <option value="0.75">Lite l√•ngsam</option>
                    <option value="1" selected>Normal</option>
                    <option value="1.25">Lite snabb</option>
                    <option value="1.5">Snabb</option>
                </select>
            </span>
            <button id="read-page-btn" class="read-aloud-btn">üîä L√§s upp hela sidan</button>
            <button id="stop-reading-btn" class="read-aloud-btn" style="display:none;">‚èπÔ∏è Stoppa uppl√§sning</button>
        </div>
    </div>
    <div id="news-sammanfattning">
        <div class="sammanfattning-content"><h3>Dagens Nyheter</h3>Error creating daily summary</div>
    </div>
    <div id="news-profil" style="display:none;">
        <div class="profile-content"><h3>Dagens person: Pia Sundhage</h3><div class="person-context"><strong>Varf√∂r √§r Pia Sundhage dagens person?</strong><br>Den 65-√•riga svenska fotbollstr√§naren ledde det schweiziska landslaget till deras f√∂rsta EM-kvartsfinal n√•gonsin, och visade d√§rmed vilka fantastiska m√∂jligheter som finns n√§r man tror p√• sig sj√§lv och sitt lag.</div><div class="biography">Pia Sundhage: En Fotbollsikon som Forts√§tter att Inspirera<br><br>Pia Mariane Sundhage, 65 √•r, √§r en av svensk damfotbolls allra st√∂rsta profiler genom tiderna. F√∂dd den 13 februari 1960 i Ulricehamn har hon gjort en enast√•ende karri√§r b√•de som spelare och tr√§nare som har f√∂r√§ndrat damfotbollens landskap (K√§lla: Wikipedia).<br><br>Som aktiv spelare var Sundhage en f√∂reg√•ngare inom fotbollen. Hon vann hela fyra SM-guld och fyra svenska cup-titlar, och blev dessutom europam√§stare 1984. Hon var ocks√• en av de f√∂rsta svenska kvinnliga utlandsproffsen, vilket var banbrytande f√∂r sin tid (K√§lla: Wikipedia).<br><br>Som tr√§nare har Sundhage skapat √§nnu mer historia. Hon vann tv√• OS-guld med USA:s landslag (2008 och 2012) och ledde Sveriges damlandslag till EM-brons och OS-silver mellan 2012-2017. Nu har hon skrivit ytterligare ett historiskt kapitel genom att leda det schweiziska landslaget till deras f√∂rsta EM-kvartsfinal n√•gonsin.<br><br>Under EM 2022 visade Sundhage √•terigen sin enast√•ende f√∂rm√•ga som tr√§nare. Trots att Schweiz f√∂rlorade kvartfinalen mot Spanien med 2-0, hade hon lyckats lyfta ett helt landslag och n√• en milstolpe som ingen schweizisk kvinna tidigare gjort.<br><br>Sundhages karri√§r √§r en inspirerande ber√§ttelse om passion, envishet och ledarskap. Hon bevisar att √•lder bara √§r en siffra och att genuint engagemang kan flytta berg. Som den f√∂rsta kvinnan invald i Svensk fotbolls Hall of Fame (2003) forts√§tter hon att vara en f√∂rebild f√∂r unga fotbollsspelare v√§rlden √∂ver.<br><br>Pia Sundhage representerar mer √§n bara fotboll - hon symboliserar m√∂jligheten att bryta barri√§rer, utmana normer och uppn√• till synes om√∂jliga dr√∂mmar.<br><br>(K√§lla: Wikipedia)</div></div>
    </div>
    <div id="news-djupanalys" style="display:none;">
        <div class="deep-dive-content"><p>Ingen djupanalys har gjorts f√∂r detta datum.</p></div>
    </div>
    <div id="news-nyheter" style="display:none;">
        <div class="folders"><button class="folder" data-folder="nyheter-Information" onclick="showFolder('nyheter','Information')">Information (4)</button><button class="folder" data-folder="nyheter-Sport" onclick="showFolder('nyheter','Sport')">Sport (0)</button><button class="folder" data-folder="nyheter-V√§der" onclick="showFolder('nyheter','V√§der')">V√§der (0)</button><button class="folder" data-folder="nyheter-Olyckor och allm√§nt el√§nde" onclick="showFolder('nyheter','Olyckor och allm√§nt el√§nde')">Olyckor och allm√§nt el√§nde (0)</button></div><div class="news-folder" id="folder-nyheter-Information" style=""><div class="article"><div class="headline">Test Related Norwegian Article</div><div class="date">2025-07-19</div><div class="summary">Test summary about related technology</div><div class="source">K√§lla: <a href="https://test.nrk.no/article2" target="_blank" rel="noopener">https://test.nrk.no/article2</a></div></div><div class="article"><div class="headline">Test Swedish Article 2</div><div class="date">2025-07-19</div><div class="summary">Test summary about technology</div><div class="source">K√§lla: <a href="https://test.svt.se/article2" target="_blank" rel="noopener">https://test.svt.se/article2</a></div></div><div class="article"><div class="headline">Test Norwegian Article 1</div><div class="date">2025-07-19</div><div class="summary">Test summary about economics</div><div class="source">K√§lla: <a href="https://test.nrk.no/article1" target="_blank" rel="noopener">https://test.nrk.no/article1</a></div></div><div class="article"><div class="headline">Test Swedish Article 1</div><div class="date">2025-07-19</div><div class="summary">Test summary about politics</div><div class="source">K√§lla: <a href="https://test.svt.se/article1" target="_blank" rel="noopener">https://test.svt.se/article1</a></div></div></div><div class="news-folder" id="folder-nyheter-Sport" style="display:none;"></div><div class="news-folder" id="folder-nyheter-V√§der" style="display:none;"></div><div class="news-folder" id="folder-nyheter-Olyckor och allm√§nt el√§nde" style="display:none;"></div>
    </div>
    <div class="updated">
        Senast uppdaterad: <span id="lastUpdated">2025-07-19 20:29</span>
    </div>
    <script>
        const CATEGORY_ORDER = ["Information","Sport","V√§der","Olyckor och allm√§nt el√§nde"];
        const groupedByDate = {"2025-07-19":{"sammanfattning":{},"nyheter":{"Information":[{"headline":"Test Related Norwegian Article","date":"2025-07-19","summary":"En relatert norsk artikkel om samme teknologi tema","url":"https://test.nrk.no/article2","source":"NRK","category":"Teknik","main_subject":"Test Technology Subject","facts":"Test related technology facts","claude_summary":"Test summary about related technology","tag":"TEST_TAG_4"},{"headline":"Test Swedish Article 2","date":"2025-07-19","summary":"Another test Swedish article about technology","url":"https://test.svt.se/article2","source":"SVT","category":"Teknik","main_subject":"Test Technology Subject","facts":"Test technology facts","claude_summary":"Test summary about technology","tag":"TEST_TAG_3"},{"headline":"Test Norwegian Article 1","date":"2025-07-19","summary":"Dette er en test norsk artikkel om √∏konomi","url":"https://test.nrk.no/article1","source":"NRK","category":"Ekonomi","main_subject":"Test Economics Subject","facts":"Test economic facts","claude_summary":"Test summary about economics","tag":"TEST_TAG_2"},{"headline":"Test Swedish Article 1","date":"2025-07-19","summary":"This is a test Swedish article about politics","url":"https://test.svt.se/article1","source":"SVT","category":"Politik","main_subject":"Test Politics Subject","facts":"Test political facts","claude_summary":"Test summary about politics","tag":"TEST_TAG_1"}]}}};
        const sammanfattningByDate = {"2025-07-19":"<div class=\"sammanfattning-content\"><h3>Dagens Nyheter</h3>Error creating daily summary</div>"};
        const profileByDate = {"2025-07-19":"<div class=\"profile-content\"><h3>Dagens person: Pia Sundhage</h3><div class=\"person-context\"><strong>Varf√∂r √§r Pia Sundhage dagens person?</strong><br>Den 65-√•riga svenska fotbollstr√§naren ledde det schweiziska landslaget till deras f√∂rsta EM-kvartsfinal n√•gonsin, och visade d√§rmed vilka fantastiska m√∂jligheter som finns n√§r man tror p√• sig sj√§lv och sitt lag.</div><div class=\"biography\">Pia Sundhage: En Fotbollsikon som Forts√§tter att Inspirera<br><br>Pia Mariane Sundhage, 65 √•r, √§r en av svensk damfotbolls allra st√∂rsta profiler genom tiderna. F√∂dd den 13 februari 1960 i Ulricehamn har hon gjort en enast√•ende karri√§r b√•de som spelare och tr√§nare som har f√∂r√§ndrat damfotbollens landskap (K√§lla: Wikipedia).<br><br>Som aktiv spelare var Sundhage en f√∂reg√•ngare inom fotbollen. Hon vann hela fyra SM-guld och fyra svenska cup-titlar, och blev dessutom europam√§stare 1984. Hon var ocks√• en av de f√∂rsta svenska kvinnliga utlandsproffsen, vilket var banbrytande f√∂r sin tid (K√§lla: Wikipedia).<br><br>Som tr√§nare har Sundhage skapat √§nnu mer historia. Hon vann tv√• OS-guld med USA:s landslag (2008 och 2012) och ledde Sveriges damlandslag till EM-brons och OS-silver mellan 2012-2017. Nu har hon skrivit ytterligare ett historiskt kapitel genom att leda det schweiziska landslaget till deras f√∂rsta EM-kvartsfinal n√•gonsin.<br><br>Under EM 2022 visade Sundhage √•terigen sin enast√•ende f√∂rm√•ga som tr√§nare. Trots att Schweiz f√∂rlorade kvartfinalen mot Spanien med 2-0, hade hon lyckats lyfta ett helt landslag och n√• en milstolpe som ingen schweizisk kvinna tidigare gjort.<br><br>Sundhages karri√§r √§r en inspirerande ber√§ttelse om passion, envishet och ledarskap. Hon bevisar att √•lder bara √§r en siffra och att genuint engagemang kan flytta berg. Som den f√∂rsta kvinnan invald i Svensk fotbolls Hall of Fame (2003) forts√§tter hon att vara en f√∂rebild f√∂r unga fotbollsspelare v√§rlden √∂ver.<br><br>Pia Sundhage representerar mer √§n bara fotboll - hon symboliserar m√∂jligheten att bryta barri√§rer, utmana normer och uppn√• till synes om√∂jliga dr√∂mmar.<br><br>(K√§lla: Wikipedia)</div></div>"};
        const deepDiveByDate = {"2025-07-19":"<div class=\"deep-dive-content\"><p>Ingen djupanalys har gjorts f√∂r detta datum.</p></div>"};
        let currentDate = "2025-07-19";
        let activeTab = 'sammanfattning';
        function renderCategoryFolders(groups, tabName) {
            if (tabName === 'sammanfattning') {
                // Do not render subcategories for Sammanfattning
                return '';
            }
            var html = '<div class="folders">';
            CATEGORY_ORDER.forEach(function(cat) {
                var list = groups[cat] || [];
                html += '<button class="folder" data-folder="' + tabName + '-' + cat + '">' +
                    cat + ' (' + list.length + ')</button>';
            });
            html += '</div>';
            CATEGORY_ORDER.forEach(function(cat) {
                var list = groups[cat] || [];
                html += '<div class="news-folder" id="folder-' + tabName + '-' + cat + '" style="' + (cat === CATEGORY_ORDER[0] ? '' : 'display:none;') + '">';
                list.forEach(function(a) {
                    let sourceHtml = '';
                    if (a.url) {
                        if (a.url.indexOf('svt.se/text-tv') !== -1) {
                            sourceHtml = '<div class="source">K√§lla: <a href="https://www.svt.se/text-tv/" target="_blank" rel="noopener">https://www.svt.se/text-tv/</a></div>';
                        } else {
                            sourceHtml = '<div class="source">K√§lla: <a href="' + a.url + '" target="_blank" rel="noopener">' + a.url + '</a></div>';
                        }
                    }
                    html += '<div class="article">' +
                        '<div class="headline">' + a.headline + '</div>' +
                        '<div class="date">' + a.date + '</div>' +
                        '<div class="summary">' + a.claude_summary + '</div>' +
                        sourceHtml +
                        '</div>';
                });
                html += '</div>';
            });
            return html;
        }

        // (No browser-side renderSammanfattningContent; handled server-side)
        function showTab(tab) {
            activeTab = tab;
            document.getElementById('news-sammanfattning').style.display = tab === 'sammanfattning' ? '' : 'none';
            document.getElementById('news-profil').style.display = tab === 'profil' ? '' : 'none';
            document.getElementById('news-djupanalys').style.display = tab === 'djupanalys' ? '' : 'none';
            document.getElementById('news-nyheter').style.display = tab === 'nyheter' ? '' : 'none';
            document.getElementById('tab-sammanfattning').classList.toggle('active', tab === 'sammanfattning');
            document.getElementById('tab-profil').classList.toggle('active', tab === 'profil');
            document.getElementById('tab-djupanalys').classList.toggle('active', tab === 'djupanalys');
            document.getElementById('tab-nyheter').classList.toggle('active', tab === 'nyheter');
            // Always update content for current date when switching tabs
            if (tab === 'sammanfattning') {
                document.getElementById('news-sammanfattning').innerHTML = sammanfattningByDate[currentDate] || '<div class="sammanfattning-content">Sammanfattningstext kommer h√§r.</div>';
            } else if (tab === 'profil') {
                document.getElementById('news-profil').innerHTML = profileByDate[currentDate] || '<div class="profile-content"><p>Ingen person har valts f√∂r detta datum.</p></div>';
            } else if (tab === 'djupanalys') {
                document.getElementById('news-djupanalys').innerHTML = deepDiveByDate[currentDate] || '<div class="deep-dive-content"><p>Ingen djupanalys har gjorts f√∂r detta datum.</p></div>';
            }
        }
        function showFolder(tab, cat) {
            const base = tab + '-' + cat;
            CATEGORY_ORDER.forEach(function(c) {
                const folderElem = document.getElementById('folder-' + tab + '-' + c);
                if (folderElem) {
                    folderElem.style.display = (c === cat) ? '' : 'none';
                }
                Array.from(document.querySelectorAll('button.folder[data-folder^="' + tab + '-"]')).forEach(function(btn) {
                    btn.classList.toggle('active', btn.getAttribute('data-folder') === base);
                });
            });
        }
        function setDate(date) {
            currentDate = date;
            // Always update Sammanfattning for selected date
            document.getElementById('news-sammanfattning').innerHTML = sammanfattningByDate[date] || '<div class="sammanfattning-content">Sammanfattningstext kommer h√§r.</div>';
            // Always update Profile for selected date
            document.getElementById('news-profil').innerHTML = profileByDate[date] || '<div class="profile-content"><p>Ingen person har valts f√∂r detta datum.</p></div>';
            // Always update Deep Dive for selected date
            document.getElementById('news-djupanalys').innerHTML = deepDiveByDate[date] || '<div class="deep-dive-content"><p>Ingen djupanalys har gjorts f√∂r detta datum.</p></div>';
            // Re-render news folders for selected date
            const nyheterNews = groupedByDate[date]?.nyheter || {};
            document.getElementById('news-nyheter').innerHTML = renderCategoryFolders(nyheterNews, 'nyheter');
            // Re-init folders and attach folder button listeners
            attachFolderListeners('nyheter');
            showFolder('nyheter', CATEGORY_ORDER[0]);
        }
        function attachDateListeners() {
            // Update immediately on dropdown change
            document.getElementById('date-select').addEventListener('change', function() {
                setDate(this.value);
            });
        }
        function attachTabListeners() {
            document.getElementById('tab-sammanfattning').addEventListener('click', function() { showTab('sammanfattning'); });
            document.getElementById('tab-profil').addEventListener('click', function() { showTab('profil'); });
            document.getElementById('tab-djupanalys').addEventListener('click', function() { showTab('djupanalys'); });
            document.getElementById('tab-nyheter').addEventListener('click', function() { showTab('nyheter'); });
        }
        function attachFolderListeners(tabName) {
            CATEGORY_ORDER.forEach(function(cat) {
                var btn = document.querySelector('button.folder[data-folder="' + tabName + '-' + cat + '"]');
                if (btn) {
                    btn.addEventListener('click', function() { showFolder(tabName, cat); });
                }
            });
        }
        // Initial listeners
        attachDateListeners();
        attachTabListeners();
        attachFolderListeners('sammanfattning');
        attachFolderListeners('nyheter');
        // Initialize first folder as active
        showTab('sammanfattning');
        showFolder('sammanfattning', CATEGORY_ORDER[0]);
        showFolder('nyheter', CATEGORY_ORDER[0]);
        
        // Text-to-Speech functionality
        let currentSpeech = null;
        let isReading = false;
        
        function stopSpeech() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
                isReading = false;
                document.getElementById('read-page-btn').style.display = '';
                document.getElementById('stop-reading-btn').style.display = 'none';
                // Remove highlighting
                document.querySelectorAll('.reading-highlight').forEach(el => {
                    el.classList.remove('reading-highlight');
                });
            }
        }
        
        function readText(text, highlightElement = null) {
            if (!('speechSynthesis' in window)) {
                alert('Din webbl√§sare st√∂der inte text-till-tal funktionalitet.');
                return;
            }
            
            stopSpeech();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'sv-SE';
            utterance.rate = parseFloat(document.getElementById('speech-rate').value);
            
            if (highlightElement) {
                highlightElement.classList.add('reading-highlight');
            }
            
            utterance.onstart = function() {
                isReading = true;
                document.getElementById('read-page-btn').style.display = 'none';
                document.getElementById('stop-reading-btn').style.display = '';
            };
            
            utterance.onend = function() {
                isReading = false;
                document.getElementById('read-page-btn').style.display = '';
                document.getElementById('stop-reading-btn').style.display = 'none';
                if (highlightElement) {
                    highlightElement.classList.remove('reading-highlight');
                }
            };
            
            currentSpeech = utterance;
            speechSynthesis.speak(utterance);
        }
        
        function readCurrentContent() {
            let contentToRead = '';
            let titleToRead = '';
            
            if (activeTab === 'sammanfattning') {
                const summaryContent = document.getElementById('news-sammanfattning');
                const titleElement = summaryContent.querySelector('h3');
                if (titleElement) {
                    titleToRead = titleElement.textContent + '. ';
                }
                
                // Get text content without HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = summaryContent.innerHTML;
                // Remove title from content since we read it separately
                if (tempDiv.querySelector('h3')) {
                    tempDiv.querySelector('h3').remove();
                }
                contentToRead = titleToRead + tempDiv.textContent.trim();
            } else if (activeTab === 'profil') {
                const profileContent = document.getElementById('news-profil');
                const titleElement = profileContent.querySelector('h3');
                if (titleElement) {
                    titleToRead = titleElement.textContent + '. ';
                }
                
                // Get text content without HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = profileContent.innerHTML;
                // Remove title from content since we read it separately
                if (tempDiv.querySelector('h3')) {
                    tempDiv.querySelector('h3').remove();
                }
                contentToRead = titleToRead + tempDiv.textContent.trim();
            } else if (activeTab === 'djupanalys') {
                const deepDiveContent = document.getElementById('news-djupanalys');
                const titleElement = deepDiveContent.querySelector('h3');
                if (titleElement) {
                    titleToRead = titleElement.textContent + '. ';
                }
                
                // Get text content without HTML
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = deepDiveContent.innerHTML;
                // Remove title from content since we read it separately
                if (tempDiv.querySelector('h3')) {
                    tempDiv.querySelector('h3').remove();
                }
                contentToRead = titleToRead + tempDiv.textContent.trim();
            } else {
                // Read visible news articles
                const visibleFolder = document.querySelector('.news-folder:not([style*="display:none"])');
                if (visibleFolder) {
                    const articles = visibleFolder.querySelectorAll('.article');
                    const articleTexts = Array.from(articles).map(article => {
                        const headline = article.querySelector('.headline')?.textContent || '';
                        const summary = article.querySelector('.summary')?.textContent || '';
                        return headline + '. ' + summary;
                    });
                    contentToRead = articleTexts.join('. ');
                }
            }
            
            if (contentToRead.trim()) {
                readText(contentToRead);
            } else {
                alert('Ingen text att l√§sa upp hittades.');
            }
        }
        
        // Event listeners for speech controls
        document.getElementById('read-page-btn').addEventListener('click', readCurrentContent);
        document.getElementById('stop-reading-btn').addEventListener('click', stopSpeech);
        
        // Add reading highlight CSS
        const style = document.createElement('style');
        style.textContent = '.reading-highlight { background-color: #ffffaa; }';
        document.head.appendChild(style);
    </script>
</body>
</html>
